<html>
    <head>
        <script
            type="text/javascript"
            src="../../../js/jquery-1.4.2.min.js">
        </script>
        <script
            type="text/javascript"
            src="../../../syntax_highlighter/scripts/shCore.js">
        </script>
        <script
            type="text/javascript"
            src="../../../syntax_highlighter/scripts/shBrushJScript.js">
        </script>
        <script
            type="text/javascript"
            src="../../../syntax_highlighter/scripts/shBrushPhp.js">
        </script>
        <script
            type="text/javascript"
            src="../../../syntax_highlighter/scripts/shBrushXml.js">
        </script>
        <link
            href="../../../syntax_highlighter/styles/shCore.css" rel="stylesheet"
            type="text/css"
        />
        <link
            href="../../../syntax_highlighter/styles/shCoreEclipse.css"
            rel="stylesheet" type="text/css"
        />
        <link
            href="../../../syntax_highlighter/styles/shThemeWordpress.css"
            rel="stylesheet" type="text/css"
        />
    </head>
    <body>
        <pre class="brush: php">&lt;?php

class CandidateUpdateRequest extends EntityUpdate {
	
	function schema_version(){
		return ($this-&gt;changed)? $this-&gt;changed-&gt;get_class_version() : $this-&gt;original-&gt;get_class_version();
	}
	
	function prepareRestore($dacura_server, $version){
		$changed = $dacura_server-&gt;getCandidate($this-&gt;targetid, false, $version);
		if(!$changed){
			return $this-&gt;failure_result($dacura_server-&gt;errmsg, $dacura_server-&gt;errcode);
		}
		$this-&gt;changed = $changed;
		$this-&gt;changed-&gt;version = $this-&gt;to_version ? $this-&gt;to_version : 1 + $this-&gt;changed-&gt;latest_version;
		if($this-&gt;changed-&gt;version &gt; $this-&gt;changed-&gt;latest_version){
			$this-&gt;changed-&gt;latest_version = $this-&gt;changed-&gt;version;
		}
		$this-&gt;calculateDelta(true);
		return true;
	}
	
	function updateImportedProps($contents){
		$this-&gt;changed-&gt;ldprops = array(&quot;main&quot; =&gt; $contents);
	}	
}
</pre>
        <script type="text/javascript">
             SyntaxHighlighter.all();
             jQuery('.gutter div').each(function(key, data){
                jQuery(data).prepend('<a name="L'+jQuery(data).text()+'"/>');
             });
        </script>
    </body>
</html>