<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: media/js/DataTables-1.9.4/DataTables-1.9.4/media/src/core/core.draw.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: media/js/DataTables-1.9.4/DataTables-1.9.4/media/src/core/core.draw.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Create a new TR element (and it's TD children) for a row
 *  @param {object} oSettings dataTables settings object
 *  @param {int} iRow Row to consider
 *  @memberof DataTable#oApi
 */
function _fnCreateTr ( oSettings, iRow )
{
	var oData = oSettings.aoData[iRow];
	var nTd;

	if ( oData.nTr === null )
	{
		oData.nTr = document.createElement('tr');

		/* Use a private property on the node to allow reserve mapping from the node
		 * to the aoData array for fast look up
		 */
		oData.nTr._DT_RowIndex = iRow;

		/* Special parameters can be given by the data source to be used on the row */
		if ( oData._aData.DT_RowId )
		{
			oData.nTr.id = oData._aData.DT_RowId;
		}

		if ( oData._aData.DT_RowClass )
		{
			oData.nTr.className = oData._aData.DT_RowClass;
		}

		/* Process each column */
		for ( var i=0, iLen=oSettings.aoColumns.length ; i&lt;iLen ; i++ )
		{
			var oCol = oSettings.aoColumns[i];
			nTd = document.createElement( oCol.sCellType );

			/* Render if needed - if bUseRendered is true then we already have the rendered
			 * value in the data source - so can just use that
			 */
			nTd.innerHTML = (typeof oCol.fnRender === 'function' &amp;&amp; (!oCol.bUseRendered || oCol.mData === null)) ?
				_fnRender( oSettings, iRow, i ) :
				_fnGetCellData( oSettings, iRow, i, 'display' );
		
			/* Add user defined class */
			if ( oCol.sClass !== null )
			{
				nTd.className = oCol.sClass;
			}
			
			if ( oCol.bVisible )
			{
				oData.nTr.appendChild( nTd );
				oData._anHidden[i] = null;
			}
			else
			{
				oData._anHidden[i] = nTd;
			}

			if ( oCol.fnCreatedCell )
			{
				oCol.fnCreatedCell.call( oSettings.oInstance,
					nTd, _fnGetCellData( oSettings, iRow, i, 'display' ), oData._aData, iRow, i
				);
			}
		}

		_fnCallbackFire( oSettings, 'aoRowCreatedCallback', null, [oData.nTr, oData._aData, iRow] );
	}
}


/**
 * Create the HTML header for the table
 *  @param {object} oSettings dataTables settings object
 *  @memberof DataTable#oApi
 */
function _fnBuildHead( oSettings )
{
	var i, nTh, iLen, j, jLen;
	var iThs = $('th, td', oSettings.nTHead).length;
	var iCorrector = 0;
	var jqChildren;
	
	/* If there is a header in place - then use it - otherwise it's going to get nuked... */
	if ( iThs !== 0 )
	{
		/* We've got a thead from the DOM, so remove hidden columns and apply width to vis cols */
		for ( i=0, iLen=oSettings.aoColumns.length ; i&lt;iLen ; i++ )
		{
			nTh = oSettings.aoColumns[i].nTh;
			nTh.setAttribute('role', 'columnheader');
			if ( oSettings.aoColumns[i].bSortable )
			{
				nTh.setAttribute('tabindex', oSettings.iTabIndex);
				nTh.setAttribute('aria-controls', oSettings.sTableId);
			}

			if ( oSettings.aoColumns[i].sClass !== null )
			{
				$(nTh).addClass( oSettings.aoColumns[i].sClass );
			}
			
			/* Set the title of the column if it is user defined (not what was auto detected) */
			if ( oSettings.aoColumns[i].sTitle != nTh.innerHTML )
			{
				nTh.innerHTML = oSettings.aoColumns[i].sTitle;
			}
		}
	}
	else
	{
		/* We don't have a header in the DOM - so we are going to have to create one */
		var nTr = document.createElement( "tr" );
		
		for ( i=0, iLen=oSettings.aoColumns.length ; i&lt;iLen ; i++ )
		{
			nTh = oSettings.aoColumns[i].nTh;
			nTh.innerHTML = oSettings.aoColumns[i].sTitle;
			nTh.setAttribute('tabindex', '0');
			
			if ( oSettings.aoColumns[i].sClass !== null )
			{
				$(nTh).addClass( oSettings.aoColumns[i].sClass );
			}
			
			nTr.appendChild( nTh );
		}
		$(oSettings.nTHead).html( '' )[0].appendChild( nTr );
		_fnDetectHeader( oSettings.aoHeader, oSettings.nTHead );
	}
	
	/* ARIA role for the rows */	
	$(oSettings.nTHead).children('tr').attr('role', 'row');
	
	/* Add the extra markup needed by jQuery UI's themes */
	if ( oSettings.bJUI )
	{
		for ( i=0, iLen=oSettings.aoColumns.length ; i&lt;iLen ; i++ )
		{
			nTh = oSettings.aoColumns[i].nTh;
			
			var nDiv = document.createElement('div');
			nDiv.className = oSettings.oClasses.sSortJUIWrapper;
			$(nTh).contents().appendTo(nDiv);
			
			var nSpan = document.createElement('span');
			nSpan.className = oSettings.oClasses.sSortIcon;
			nDiv.appendChild( nSpan );
			nTh.appendChild( nDiv );
		}
	}
	
	if ( oSettings.oFeatures.bSort )
	{
		for ( i=0 ; i&lt;oSettings.aoColumns.length ; i++ )
		{
			if ( oSettings.aoColumns[i].bSortable !== false )
			{
				_fnSortAttachListener( oSettings, oSettings.aoColumns[i].nTh, i );
			}
			else
			{
				$(oSettings.aoColumns[i].nTh).addClass( oSettings.oClasses.sSortableNone );
			}
		}
	}
	
	/* Deal with the footer - add classes if required */
	if ( oSettings.oClasses.sFooterTH !== "" )
	{
		$(oSettings.nTFoot).children('tr').children('th').addClass( oSettings.oClasses.sFooterTH );
	}
	
	/* Cache the footer elements */
	if ( oSettings.nTFoot !== null )
	{
		var anCells = _fnGetUniqueThs( oSettings, null, oSettings.aoFooter );
		for ( i=0, iLen=oSettings.aoColumns.length ; i&lt;iLen ; i++ )
		{
			if ( anCells[i] )
			{
				oSettings.aoColumns[i].nTf = anCells[i];
				if ( oSettings.aoColumns[i].sClass )
				{
					$(anCells[i]).addClass( oSettings.aoColumns[i].sClass );
				}
			}
		}
	}
}


/**
 * Draw the header (or footer) element based on the column visibility states. The
 * methodology here is to use the layout array from _fnDetectHeader, modified for
 * the instantaneous column visibility, to construct the new layout. The grid is
 * traversed over cell at a time in a rows x columns grid fashion, although each 
 * cell insert can cover multiple elements in the grid - which is tracks using the
 * aApplied array. Cell inserts in the grid will only occur where there isn't
 * already a cell in that position.
 *  @param {object} oSettings dataTables settings object
 *  @param array {objects} aoSource Layout array from _fnDetectHeader
 *  @param {boolean} [bIncludeHidden=false] If true then include the hidden columns in the calc, 
 *  @memberof DataTable#oApi
 */
function _fnDrawHead( oSettings, aoSource, bIncludeHidden )
{
	var i, iLen, j, jLen, k, kLen, n, nLocalTr;
	var aoLocal = [];
	var aApplied = [];
	var iColumns = oSettings.aoColumns.length;
	var iRowspan, iColspan;

	if (  bIncludeHidden === undefined )
	{
		bIncludeHidden = false;
	}

	/* Make a copy of the master layout array, but without the visible columns in it */
	for ( i=0, iLen=aoSource.length ; i&lt;iLen ; i++ )
	{
		aoLocal[i] = aoSource[i].slice();
		aoLocal[i].nTr = aoSource[i].nTr;

		/* Remove any columns which are currently hidden */
		for ( j=iColumns-1 ; j>=0 ; j-- )
		{
			if ( !oSettings.aoColumns[j].bVisible &amp;&amp; !bIncludeHidden )
			{
				aoLocal[i].splice( j, 1 );
			}
		}

		/* Prep the applied array - it needs an element for each row */
		aApplied.push( [] );
	}

	for ( i=0, iLen=aoLocal.length ; i&lt;iLen ; i++ )
	{
		nLocalTr = aoLocal[i].nTr;
		
		/* All cells are going to be replaced, so empty out the row */
		if ( nLocalTr )
		{
			while( (n = nLocalTr.firstChild) )
			{
				nLocalTr.removeChild( n );
			}
		}

		for ( j=0, jLen=aoLocal[i].length ; j&lt;jLen ; j++ )
		{
			iRowspan = 1;
			iColspan = 1;

			/* Check to see if there is already a cell (row/colspan) covering our target
			 * insert point. If there is, then there is nothing to do.
			 */
			if ( aApplied[i][j] === undefined )
			{
				nLocalTr.appendChild( aoLocal[i][j].cell );
				aApplied[i][j] = 1;

				/* Expand the cell to cover as many rows as needed */
				while ( aoLocal[i+iRowspan] !== undefined &amp;&amp;
				        aoLocal[i][j].cell == aoLocal[i+iRowspan][j].cell )
				{
					aApplied[i+iRowspan][j] = 1;
					iRowspan++;
				}

				/* Expand the cell to cover as many columns as needed */
				while ( aoLocal[i][j+iColspan] !== undefined &amp;&amp;
				        aoLocal[i][j].cell == aoLocal[i][j+iColspan].cell )
				{
					/* Must update the applied array over the rows for the columns */
					for ( k=0 ; k&lt;iRowspan ; k++ )
					{
						aApplied[i+k][j+iColspan] = 1;
					}
					iColspan++;
				}

				/* Do the actual expansion in the DOM */
				aoLocal[i][j].cell.rowSpan = iRowspan;
				aoLocal[i][j].cell.colSpan = iColspan;
			}
		}
	}
}


/**
 * Insert the required TR nodes into the table for display
 *  @param {object} oSettings dataTables settings object
 *  @memberof DataTable#oApi
 */
function _fnDraw( oSettings )
{
	/* Provide a pre-callback function which can be used to cancel the draw is false is returned */
	var aPreDraw = _fnCallbackFire( oSettings, 'aoPreDrawCallback', 'preDraw', [oSettings] );
	if ( $.inArray( false, aPreDraw ) !== -1 )
	{
		_fnProcessingDisplay( oSettings, false );
		return;
	}
	
	var i, iLen, n;
	var anRows = [];
	var iRowCount = 0;
	var iStripes = oSettings.asStripeClasses.length;
	var iOpenRows = oSettings.aoOpenRows.length;
	
	oSettings.bDrawing = true;
	
	/* Check and see if we have an initial draw position from state saving */
	if ( oSettings.iInitDisplayStart !== undefined &amp;&amp; oSettings.iInitDisplayStart != -1 )
	{
		if ( oSettings.oFeatures.bServerSide )
		{
			oSettings._iDisplayStart = oSettings.iInitDisplayStart;
		}
		else
		{
			oSettings._iDisplayStart = (oSettings.iInitDisplayStart >= oSettings.fnRecordsDisplay()) ?
				0 : oSettings.iInitDisplayStart;
		}
		oSettings.iInitDisplayStart = -1;
		_fnCalculateEnd( oSettings );
	}
	
	/* Server-side processing draw intercept */
	if ( oSettings.bDeferLoading )
	{
		oSettings.bDeferLoading = false;
		oSettings.iDraw++;
	}
	else if ( !oSettings.oFeatures.bServerSide )
	{
		oSettings.iDraw++;
	}
	else if ( !oSettings.bDestroying &amp;&amp; !_fnAjaxUpdate( oSettings ) )
	{
		return;
	}
	
	if ( oSettings.aiDisplay.length !== 0 )
	{
		var iStart = oSettings._iDisplayStart;
		var iEnd = oSettings._iDisplayEnd;
		
		if ( oSettings.oFeatures.bServerSide )
		{
			iStart = 0;
			iEnd = oSettings.aoData.length;
		}
		
		for ( var j=iStart ; j&lt;iEnd ; j++ )
		{
			var aoData = oSettings.aoData[ oSettings.aiDisplay[j] ];
			if ( aoData.nTr === null )
			{
				_fnCreateTr( oSettings, oSettings.aiDisplay[j] );
			}

			var nRow = aoData.nTr;
			
			/* Remove the old striping classes and then add the new one */
			if ( iStripes !== 0 )
			{
				var sStripe = oSettings.asStripeClasses[ iRowCount % iStripes ];
				if ( aoData._sRowStripe != sStripe )
				{
					$(nRow).removeClass( aoData._sRowStripe ).addClass( sStripe );
					aoData._sRowStripe = sStripe;
				}
			}
			
			/* Row callback functions - might want to manipulate the row */
			_fnCallbackFire( oSettings, 'aoRowCallback', null, 
				[nRow, oSettings.aoData[ oSettings.aiDisplay[j] ]._aData, iRowCount, j] );
			
			anRows.push( nRow );
			iRowCount++;
			
			/* If there is an open row - and it is attached to this parent - attach it on redraw */
			if ( iOpenRows !== 0 )
			{
				for ( var k=0 ; k&lt;iOpenRows ; k++ )
				{
					if ( nRow == oSettings.aoOpenRows[k].nParent )
					{
						anRows.push( oSettings.aoOpenRows[k].nTr );
						break;
					}
				}
			}
		}
	}
	else
	{
		/* Table is empty - create a row with an empty message in it */
		anRows[ 0 ] = document.createElement( 'tr' );
		
		if ( oSettings.asStripeClasses[0] )
		{
			anRows[ 0 ].className = oSettings.asStripeClasses[0];
		}

		var oLang = oSettings.oLanguage;
		var sZero = oLang.sZeroRecords;
		if ( oSettings.iDraw == 1 &amp;&amp; oSettings.sAjaxSource !== null &amp;&amp; !oSettings.oFeatures.bServerSide )
		{
			sZero = oLang.sLoadingRecords;
		}
		else if ( oLang.sEmptyTable &amp;&amp; oSettings.fnRecordsTotal() === 0 )
		{
			sZero = oLang.sEmptyTable;
		}

		var nTd = document.createElement( 'td' );
		nTd.setAttribute( 'valign', "top" );
		nTd.colSpan = _fnVisbleColumns( oSettings );
		nTd.className = oSettings.oClasses.sRowEmpty;
		nTd.innerHTML = _fnInfoMacros( oSettings, sZero );
		
		anRows[ iRowCount ].appendChild( nTd );
	}
	
	/* Header and footer callbacks */
	_fnCallbackFire( oSettings, 'aoHeaderCallback', 'header', [ $(oSettings.nTHead).children('tr')[0], 
		_fnGetDataMaster( oSettings ), oSettings._iDisplayStart, oSettings.fnDisplayEnd(), oSettings.aiDisplay ] );
	
	_fnCallbackFire( oSettings, 'aoFooterCallback', 'footer', [ $(oSettings.nTFoot).children('tr')[0], 
		_fnGetDataMaster( oSettings ), oSettings._iDisplayStart, oSettings.fnDisplayEnd(), oSettings.aiDisplay ] );
	
	/* 
	 * Need to remove any old row from the display - note we can't just empty the tbody using
	 * $().html('') since this will unbind the jQuery event handlers (even although the node 
	 * still exists!) - equally we can't use innerHTML, since IE throws an exception.
	 */
	var
		nAddFrag = document.createDocumentFragment(),
		nRemoveFrag = document.createDocumentFragment(),
		nBodyPar, nTrs;
	
	if ( oSettings.nTBody )
	{
		nBodyPar = oSettings.nTBody.parentNode;
		nRemoveFrag.appendChild( oSettings.nTBody );
		
		/* When doing infinite scrolling, only remove child rows when sorting, filtering or start
		 * up. When not infinite scroll, always do it.
		 */
		if ( !oSettings.oScroll.bInfinite || !oSettings._bInitComplete ||
		 	oSettings.bSorted || oSettings.bFiltered )
		{
			while( (n = oSettings.nTBody.firstChild) )
			{
				oSettings.nTBody.removeChild( n );
			}
		}
		
		/* Put the draw table into the dom */
		for ( i=0, iLen=anRows.length ; i&lt;iLen ; i++ )
		{
			nAddFrag.appendChild( anRows[i] );
		}
		
		oSettings.nTBody.appendChild( nAddFrag );
		if ( nBodyPar !== null )
		{
			nBodyPar.appendChild( oSettings.nTBody );
		}
	}
	
	/* Call all required callback functions for the end of a draw */
	_fnCallbackFire( oSettings, 'aoDrawCallback', 'draw', [oSettings] );
	
	/* Draw is complete, sorting and filtering must be as well */
	oSettings.bSorted = false;
	oSettings.bFiltered = false;
	oSettings.bDrawing = false;
	
	if ( oSettings.oFeatures.bServerSide )
	{
		_fnProcessingDisplay( oSettings, false );
		if ( !oSettings._bInitComplete )
		{
			_fnInitComplete( oSettings );
		}
	}
}


/**
 * Redraw the table - taking account of the various features which are enabled
 *  @param {object} oSettings dataTables settings object
 *  @memberof DataTable#oApi
 */
function _fnReDraw( oSettings )
{
	if ( oSettings.oFeatures.bSort )
	{
		/* Sorting will refilter and draw for us */
		_fnSort( oSettings, oSettings.oPreviousSearch );
	}
	else if ( oSettings.oFeatures.bFilter )
	{
		/* Filtering will redraw for us */
		_fnFilterComplete( oSettings, oSettings.oPreviousSearch );
	}
	else
	{
		_fnCalculateEnd( oSettings );
		_fnDraw( oSettings );
	}
}


/**
 * Add the options to the page HTML for the table
 *  @param {object} oSettings dataTables settings object
 *  @memberof DataTable#oApi
 */
function _fnAddOptionsHtml ( oSettings )
{
	/*
	 * Create a temporary, empty, div which we can later on replace with what we have generated
	 * we do it this way to rendering the 'options' html offline - speed :-)
	 */
	var nHolding = $('&lt;div>&lt;/div>')[0];
	oSettings.nTable.parentNode.insertBefore( nHolding, oSettings.nTable );
	
	/* 
	 * All DataTables are wrapped in a div
	 */
	oSettings.nTableWrapper = $('&lt;div id="'+oSettings.sTableId+'_wrapper" class="'+oSettings.oClasses.sWrapper+'" role="grid">&lt;/div>')[0];
	oSettings.nTableReinsertBefore = oSettings.nTable.nextSibling;

	/* Track where we want to insert the option */
	var nInsertNode = oSettings.nTableWrapper;
	
	/* Loop over the user set positioning and place the elements as needed */
	var aDom = oSettings.sDom.split('');
	var nTmp, iPushFeature, cOption, nNewNode, cNext, sAttr, j;
	for ( var i=0 ; i&lt;aDom.length ; i++ )
	{
		iPushFeature = 0;
		cOption = aDom[i];
		
		if ( cOption == '&lt;' )
		{
			/* New container div */
			nNewNode = $('&lt;div>&lt;/div>')[0];
			
			/* Check to see if we should append an id and/or a class name to the container */
			cNext = aDom[i+1];
			if ( cNext == "'" || cNext == '"' )
			{
				sAttr = "";
				j = 2;
				while ( aDom[i+j] != cNext )
				{
					sAttr += aDom[i+j];
					j++;
				}
				
				/* Replace jQuery UI constants */
				if ( sAttr == "H" )
				{
					sAttr = oSettings.oClasses.sJUIHeader;
				}
				else if ( sAttr == "F" )
				{
					sAttr = oSettings.oClasses.sJUIFooter;
				}
				
				/* The attribute can be in the format of "#id.class", "#id" or "class" This logic
				 * breaks the string into parts and applies them as needed
				 */
				if ( sAttr.indexOf('.') != -1 )
				{
					var aSplit = sAttr.split('.');
					nNewNode.id = aSplit[0].substr(1, aSplit[0].length-1);
					nNewNode.className = aSplit[1];
				}
				else if ( sAttr.charAt(0) == "#" )
				{
					nNewNode.id = sAttr.substr(1, sAttr.length-1);
				}
				else
				{
					nNewNode.className = sAttr;
				}
				
				i += j; /* Move along the position array */
			}
			
			nInsertNode.appendChild( nNewNode );
			nInsertNode = nNewNode;
		}
		else if ( cOption == '>' )
		{
			/* End container div */
			nInsertNode = nInsertNode.parentNode;
		}
		else if ( cOption == 'l' &amp;&amp; oSettings.oFeatures.bPaginate &amp;&amp; oSettings.oFeatures.bLengthChange )
		{
			/* Length */
			nTmp = _fnFeatureHtmlLength( oSettings );
			iPushFeature = 1;
		}
		else if ( cOption == 'f' &amp;&amp; oSettings.oFeatures.bFilter )
		{
			/* Filter */
			nTmp = _fnFeatureHtmlFilter( oSettings );
			iPushFeature = 1;
		}
		else if ( cOption == 'r' &amp;&amp; oSettings.oFeatures.bProcessing )
		{
			/* pRocessing */
			nTmp = _fnFeatureHtmlProcessing( oSettings );
			iPushFeature = 1;
		}
		else if ( cOption == 't' )
		{
			/* Table */
			nTmp = _fnFeatureHtmlTable( oSettings );
			iPushFeature = 1;
		}
		else if ( cOption ==  'i' &amp;&amp; oSettings.oFeatures.bInfo )
		{
			/* Info */
			nTmp = _fnFeatureHtmlInfo( oSettings );
			iPushFeature = 1;
		}
		else if ( cOption == 'p' &amp;&amp; oSettings.oFeatures.bPaginate )
		{
			/* Pagination */
			nTmp = _fnFeatureHtmlPaginate( oSettings );
			iPushFeature = 1;
		}
		else if ( DataTable.ext.aoFeatures.length !== 0 )
		{
			/* Plug-in features */
			var aoFeatures = DataTable.ext.aoFeatures;
			for ( var k=0, kLen=aoFeatures.length ; k&lt;kLen ; k++ )
			{
				if ( cOption == aoFeatures[k].cFeature )
				{
					nTmp = aoFeatures[k].fnInit( oSettings );
					if ( nTmp )
					{
						iPushFeature = 1;
					}
					break;
				}
			}
		}
		
		/* Add to the 2D features array */
		if ( iPushFeature == 1 &amp;&amp; nTmp !== null )
		{
			if ( typeof oSettings.aanFeatures[cOption] !== 'object' )
			{
				oSettings.aanFeatures[cOption] = [];
			}
			oSettings.aanFeatures[cOption].push( nTmp );
			nInsertNode.appendChild( nTmp );
		}
	}
	
	/* Built our DOM structure - replace the holding div with what we want */
	nHolding.parentNode.replaceChild( oSettings.nTableWrapper, nHolding );
}


/**
 * Use the DOM source to create up an array of header cells. The idea here is to
 * create a layout grid (array) of rows x columns, which contains a reference
 * to the cell that that point in the grid (regardless of col/rowspan), such that
 * any column / row could be removed and the new grid constructed
 *  @param array {object} aLayout Array to store the calculated layout in
 *  @param {node} nThead The header/footer element for the table
 *  @memberof DataTable#oApi
 */
function _fnDetectHeader ( aLayout, nThead )
{
	var nTrs = $(nThead).children('tr');
	var nTr, nCell;
	var i, k, l, iLen, jLen, iColShifted, iColumn, iColspan, iRowspan;
	var bUnique;
	var fnShiftCol = function ( a, i, j ) {
		var k = a[i];
                while ( k[j] ) {
			j++;
		}
		return j;
	};

	aLayout.splice( 0, aLayout.length );
	
	/* We know how many rows there are in the layout - so prep it */
	for ( i=0, iLen=nTrs.length ; i&lt;iLen ; i++ )
	{
		aLayout.push( [] );
	}
	
	/* Calculate a layout array */
	for ( i=0, iLen=nTrs.length ; i&lt;iLen ; i++ )
	{
		nTr = nTrs[i];
		iColumn = 0;
		
		/* For every cell in the row... */
		nCell = nTr.firstChild;
		while ( nCell ) {
			if ( nCell.nodeName.toUpperCase() == "TD" ||
			     nCell.nodeName.toUpperCase() == "TH" )
			{
				/* Get the col and rowspan attributes from the DOM and sanitise them */
				iColspan = nCell.getAttribute('colspan') * 1;
				iRowspan = nCell.getAttribute('rowspan') * 1;
				iColspan = (!iColspan || iColspan===0 || iColspan===1) ? 1 : iColspan;
				iRowspan = (!iRowspan || iRowspan===0 || iRowspan===1) ? 1 : iRowspan;

				/* There might be colspan cells already in this row, so shift our target 
				 * accordingly
				 */
				iColShifted = fnShiftCol( aLayout, i, iColumn );
				
				/* Cache calculation for unique columns */
				bUnique = iColspan === 1 ? true : false;
				
				/* If there is col / rowspan, copy the information into the layout grid */
				for ( l=0 ; l&lt;iColspan ; l++ )
				{
					for ( k=0 ; k&lt;iRowspan ; k++ )
					{
						aLayout[i+k][iColShifted+l] = {
							"cell": nCell,
							"unique": bUnique
						};
						aLayout[i+k].nTr = nTr;
					}
				}
			}
			nCell = nCell.nextSibling;
		}
	}
}


/**
 * Get an array of unique th elements, one for each column
 *  @param {object} oSettings dataTables settings object
 *  @param {node} nHeader automatically detect the layout from this node - optional
 *  @param {array} aLayout thead/tfoot layout from _fnDetectHeader - optional
 *  @returns array {node} aReturn list of unique th's
 *  @memberof DataTable#oApi
 */
function _fnGetUniqueThs ( oSettings, nHeader, aLayout )
{
	var aReturn = [];
	if ( !aLayout )
	{
		aLayout = oSettings.aoHeader;
		if ( nHeader )
		{
			aLayout = [];
			_fnDetectHeader( aLayout, nHeader );
		}
	}

	for ( var i=0, iLen=aLayout.length ; i&lt;iLen ; i++ )
	{
		for ( var j=0, jLen=aLayout[i].length ; j&lt;jLen ; j++ )
		{
			if ( aLayout[i][j].unique &amp;&amp; 
				 (!aReturn[j] || !oSettings.bSortCellsTop) )
			{
				aReturn[j] = aLayout[i][j].cell;
			}
		}
	}
	
	return aReturn;
}

</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="-_anonymous_-factory-AutoFill.html">AutoFill</a></li><li><a href="-_anonymous_-factory-ColReorder.html">ColReorder</a></li><li><a href="-_anonymous_-factory-ColVis.html">ColVis</a></li><li><a href="-_anonymous_-factory-Responsive.html">Responsive</a></li><li><a href="-_anonymous_-sh.Highlighter.html">Highlighter</a></li><li><a href="DataTable.Api.html">Api</a></li><li><a href="FixedColumns.html">FixedColumns</a></li><li><a href="Scroller.html">Scroller</a></li><li><a href="DataTable_.html">~DataTable</a></li><li><a href="Scroller_.html">~Scroller</a></li></ul><h3>Events</h3><ul><li><a href="DataTable_column-sizing.html#.event:dt">dt</a></li><li><a href="DataTable_column-visibility.html#.event:dt">dt</a></li><li><a href="DataTable_destroy.html#.event:dt">dt</a></li><li><a href="DataTable_draw.html#.event:dt">dt</a></li><li><a href="DataTable.html#event:destroy">destroy</a></li><li><a href="DataTable.html#event:draw">draw</a></li><li><a href="DataTable.html#event:filter">filter</a></li><li><a href="DataTable.html#event:init">init</a></li><li><a href="DataTable.html#event:page">page</a></li><li><a href="DataTable.html#event:processing">processing</a></li><li><a href="DataTable.html#event:sort">sort</a></li><li><a href="DataTable.html#event:stateLoaded">stateLoaded</a></li><li><a href="DataTable.html#event:stateLoadParams">stateLoadParams</a></li><li><a href="DataTable.html#event:stateSaveParams">stateSaveParams</a></li><li><a href="DataTable.html#event:xhr">xhr</a></li><li><a href="DataTable_init.html#.event:dt">dt</a></li><li><a href="DataTable_length.html#.event:dt">dt</a></li><li><a href="DataTable_order.html#.event:dt">dt</a></li><li><a href="DataTable_page.html#.event:dt">dt</a></li><li><a href="DataTable_processing.html#.event:dt">dt</a></li><li><a href="DataTable_search.html#.event:dt">dt</a></li><li><a href="DataTable_stateLoaded.html#.event:dt">dt</a></li><li><a href="DataTable_stateLoadParams.html#.event:dt">dt</a></li><li><a href="DataTable_stateSaveParams.html#.event:dt">dt</a></li><li><a href="DataTable_xhr.html#.event:dt">dt</a></li><li><a href="FixedColumns_draw.html#.event:dtfc">dtfc</a></li><li><a href="FixedColumns.html#event:draw">draw</a></li></ul><h3>Namespaces</h3><ul><li><a href="-_anonymous_-factory-AutoFill.defaults.html">defaults</a></li><li><a href="-_anonymous_-factory-AutoFill.defaults.column.html">column</a></li><li><a href="-_anonymous_-factory-ColReorder.defaults.html">defaults</a></li><li><a href="-_anonymous_-FixedColumns.defaults.html">defaults</a></li><li><a href="-_anonymous_-FixedColumns_dom.html">dom</a></li><li><a href="-_anonymous_-FixedColumns_dom.clone.html">clone</a></li><li><a href="-_anonymous_-FixedColumns_dom.clone.left.html">left</a></li><li><a href="-_anonymous_-FixedColumns_dom.clone.right.html">right</a></li><li><a href="-_anonymous_-FixedColumns_dom.grid.html">grid</a></li><li><a href="-_anonymous_-FixedColumns_dom.grid.left.html">left</a></li><li><a href="-_anonymous_-FixedColumns_dom.grid.right.html">right</a></li><li><a href="-_anonymous_-FixedColumns_s.html">s</a></li><li><a href="-_ext.type.html">type</a></li><li><a href="Cached%252520information%252520about%252520the%252520border%252520display.html">Cached information about the border display</a></li><li><a href="Cached%252520information%252520about%252520the%252520little%252520dragging%252520icon%252520.html">Cached information about the little dragging icon </a></li><li><a href="Classes%252520used%252520by%252520TableTools%252520-%252520allows%252520the%252520styles%252520to%252520be%252520override%252520easily.%25250A%252520%252520Note%252520that%252520when%252520TableTools%252520initialises%252520it%252520will%252520take%252520a%252520copy%252520of%252520the%252520classes%252520object%25250A%252520%252520and%252520will%252520use%252520its%252520internal%252520copy%252520for%252520the%252520remainder%252520of%252520its%252520run%252520time..html">Classes used by TableTools - allows the styles to be override easily.
  Note that when TableTools initialises it will take a copy of the classes object
  and will use its internal copy for the remainder of its run time.</a></li><li><a href="Common%252525252525252520and%252525252525252520useful%252525252525252520DOM%252525252525252520elements%252525252525252520for%252525252525252520the%252525252525252520class%252525252525252520instance.html">Common and useful DOM elements for the class instance</a></li><li><a href="Data%252520cache%252520for%252520information%252520that%252520we%252520need%252520for%252520scrolling%252520the%252520screen%252520when%252520we%252520near%25250A%252520%252520the%252520edges.html">Data cache for information that we need for scrolling the screen when we near
  the edges</a></li><li><a href="Data%252520cache%252520for%252520the%252520position%252520of%252520the%252520DataTables%252520scrolling%252520element%252520.html">Data cache for the position of the DataTables scrolling element (when scrolling
  is enabled)</a></li><li><a href="DataTable.defaults.html">defaults</a></li><li><a href="DataTable.defaults.classes.html">classes</a></li><li><a href="DataTable.defaults.html#.column">column</a></li><li><a href="DataTable.defaults.columns.html">columns</a></li><li><a href="DataTable.defaults.language.html">language</a></li><li><a href="DataTable.defaults.language.aria.html">aria</a></li><li><a href="DataTable.defaults.language.paginate.html">paginate</a></li><li><a href="DataTable.defaults.oLanguage.html">oLanguage</a></li><li><a href="DataTable.defaults.oLanguage.oAria.html">oAria</a></li><li><a href="DataTable.defaults.oLanguage.oPaginate.html">oPaginate</a></li><li><a href="DataTable.defaults.oSearch.html">oSearch</a></li><li><a href="DataTable.defaults.search.html">search</a></li><li><a href="DataTable.ext.html">ext</a></li><li><a href="DataTable.models.html">models</a></li><li><a href="DataTable.models.ext.html">ext</a></li><li><a href="DataTable.models.oColumn.html">oColumn</a></li><li><a href="DataTable.models.oRow.html">oRow</a></li><li><a href="DataTable.models.oSearch.html">oSearch</a></li><li><a href="DataTable.models.oSettings.html">oSettings</a></li><li><a href="DataTable.models.oSettings.oBrowser.html">oBrowser</a></li><li><a href="DataTable.models.oSettings.oFeatures.html">oFeatures</a></li><li><a href="DataTable.models.oSettings.oLanguage.html">oLanguage</a></li><li><a href="DataTable.models.oSettings.oPreviousSearch.html">oPreviousSearch</a></li><li><a href="DataTable.models.oSettings.oScroll.html">oScroll</a></li><li><a href="DataTable.render.html">render</a></li><li><a href="DataTable.util.html">util</a></li><li><a href="Default%252520button%252520configurations.html">Default button configurations</a></li><li><a href="FixedColumns.defaults.html">defaults</a></li><li><a href="FixedColumns_dom.clone.html">clone</a></li><li><a href="FixedColumns_dom.clone.left.html">left</a></li><li><a href="FixedColumns_dom.clone.right.html">right</a></li><li><a href="FixedColumns_dom.grid.html">grid</a></li><li><a href="FixedColumns_dom.grid.left.html">left</a></li><li><a href="FixedColumns_dom.grid.right.html">right</a></li><li><a href="Information%252520stored%252520for%252520each%252520column.%252520An%252520array%252520of%252520objects.html"> An array of objects</a></li><li><a href="Information%252520used%252520for%252520the%252520mouse%252520drag.html">Information used for the mouse drag</a></li><li><a href="Name%252520space%252520for%252520the%252520classes%252520that%252520this%252520TableTools%252520instance%252520will%252520use.html">Name space for the classes that this TableTools instance will use</a></li><li><a href="Nodes%252520used%252520for%252520a%252520collection%252520display.%252520This%252520contains%252520the%252520currently%252520used%252520collection.html"> This contains the currently used collection</a></li><li><a href="Nodes%252520used%252520for%252520the%252520print%252520display.html">Nodes used for the print display</a></li><li><a href="oApi.html">oApi</a></li><li><a href="Print%252520specific%252520information.html">Print specific information</a></li><li><a href="Responsive.defaults.html">defaults</a></li><li><a href="Scroller.defaults.html">defaults</a></li><li><a href="Select%252520rows%252520specific%252520information.html">Select rows specific information</a></li><li><a href="Settings%2520object%2520which%2520contains%2520customisable%2520information%2520for%250A%2520%2520%2520%2520ColVis%2520instance.%2520Augmented%2520by%2520ColVis.defaults.html">Settings object which contains customisable information for
    ColVis instance. Augmented by ColVis.defaults</a></li><li><a href="Settings%252520object%252520which%252520contains%252520customisable%252520information%252520for%252520AutoFill%252520instance.html">Settings object which contains customisable information for AutoFill instance</a></li><li><a href="Settings%252520object%252520which%252520contains%252520customisable%252520information%252520for%252520ColReorder%252520instance.html">Settings object which contains customisable information for ColReorder instance</a></li><li><a href="Settings%2520object%2520which%2520contains%2520customisable%2520information%2520for%2520ColVis%2520instance.html">Settings object which contains customisable information for ColVis instance</a></li><li><a href="Settings%252520object%252520which%252520contains%252520customisable%252520information%252520for%252520TableTools%252520instance.html">Settings object which contains customisable information for TableTools instance</a></li><li><a href="Store%252520for%252520live%252520information%252520for%252520the%252520current%252520drag.html">Store for live information for the current drag</a></li><li><a href="TableTools%252520default%252520settings%252520for%252520initialisation.html">TableTools default settings for initialisation</a></li><li><a href="ThemeRoller%252520classes%252520-%252520built%252520in%252520for%252520compatibility%252520with%252520DataTables_%252520%25250A%252520%252520bJQueryUI%252520option..html">ThemeRoller classes - built in for compatibility with DataTables' 
  bJQueryUI option.</a></li><li><a href="DataTable.defaults_.html">defaults</a></li><li><a href="DataTable.defaults.columns_.html">defaults.columns</a></li><li><a href="DataTable.defaults.oLanguage_.html">oLanguage</a></li><li><a href="DataTable.defaults.oLanguage.oAria_.html">oAria</a></li><li><a href="DataTable.defaults.oLanguage.oPaginate_.html">oPaginate</a></li><li><a href="DataTable.defaults.oSearch_.html">oSearch</a></li><li><a href="DataTable.ext_.html">ext</a></li><li><a href="DataTable.models_.html">models</a></li><li><a href="DataTable.models.ext_.html">models.ext</a></li><li><a href="DataTable.models.oColumn_.html">models.oColumn</a></li><li><a href="DataTable.models.oRow_.html">models.oRow</a></li><li><a href="DataTable.models.oSearch_.html">models.oSearch</a></li><li><a href="DataTable.models.oSettings_.html">models.oSettings</a></li><li><a href="DataTable.models.oSettings.oBrowser_.html">oBrowser</a></li><li><a href="DataTable.models.oSettings.oFeatures_.html">oFeatures</a></li><li><a href="DataTable.models.oSettings.oLanguage_.html">oLanguage</a></li><li><a href="DataTable.models.oSettings.oPreviousSearch_.html">oPreviousSearch</a></li><li><a href="DataTable.models.oSettings.oScroll_.html">oScroll</a></li><li><a href="DataTable_oApi_.html">oApi</a></li><li><a href="Scroller.oDefaults.html">oDefaults</a></li><li><a href="Scroller_dom.html">dom</a></li><li><a href="Scroller_s_.html">s</a></li></ul><h3>Global</h3><ul><li><a href="global.html#$">$</a></li><li><a href="global.html#_">_</a></li><li><a href="global.html#_fnFillerDisplay">_fnFillerDisplay</a></li><li><a href="global.html#_fnFillerDragMove">_fnFillerDragMove</a></li><li><a href="global.html#_fnFillerDragStart">_fnFillerDragStart</a></li><li><a href="global.html#_fnFillerFinish">_fnFillerFinish</a></li><li><a href="global.html#_fnFillerPosition">_fnFillerPosition</a></li><li><a href="global.html#_fnInit">_fnInit</a></li><li><a href="global.html#_fnPrep">_fnPrep</a></li><li><a href="global.html#_fnReadCell">_fnReadCell</a></li><li><a href="global.html#_fnStep">_fnStep</a></li><li><a href="global.html#_fnTargetCoords">_fnTargetCoords</a></li><li><a href="global.html#_fnUpdateBorder">_fnUpdateBorder</a></li><li><a href="global.html#_fnWriteCell">_fnWriteCell</a></li><li><a href="global.html#api">api</a></li><li><a href="global.html#button">button</a></li><li><a href="global.html#CLASS">CLASS</a></li><li><a href="global.html#fnAddData">fnAddData</a></li><li><a href="global.html#fnAdjustColumnSizing">fnAdjustColumnSizing</a></li><li><a href="global.html#fnArraySwitch">fnArraySwitch</a></li><li><a href="global.html#fnClearTable">fnClearTable</a></li><li><a href="global.html#fnClose">fnClose</a></li><li><a href="global.html#fnDeleteRow">fnDeleteRow</a></li><li><a href="global.html#fnDestroy">fnDestroy</a></li><li><a href="global.html#fnDomSwitch">fnDomSwitch</a></li><li><a href="global.html#fnDraw">fnDraw</a></li><li><a href="global.html#fnFilter">fnFilter</a></li><li><a href="global.html#fnGetData">fnGetData</a></li><li><a href="global.html">fnGetInstance</a></li><li><a href="global.html">fnGetMasters</a></li><li><a href="global.html#fnGetNodes">fnGetNodes</a></li><li><a href="global.html#fnGetPosition">fnGetPosition</a></li><li><a href="global.html#fnInvertKeyValues">fnInvertKeyValues</a></li><li><a href="global.html#fnIsOpen">fnIsOpen</a></li><li><a href="global.html#fnOpen">fnOpen</a></li><li><a href="global.html#fnPageChange">fnPageChange</a></li><li><a href="global.html#fnRebuild">fnRebuild</a></li><li><a href="global.html#fnSetColumnVis">fnSetColumnVis</a></li><li><a href="global.html#fnSettings">fnSettings</a></li><li><a href="global.html#fnSort">fnSort</a></li><li><a href="global.html#fnSortListener">fnSortListener</a></li><li><a href="global.html#fnUpdate">fnUpdate</a></li><li><a href="global.html#fnVersionCheck">fnVersionCheck</a></li><li><a href="global.html#Jeditable">Jeditable</a></li><li><a href="global.html#method">method</a></li><li><a href="global.html#VERSION">VERSION</a></li><li><a href="global.html#version">version</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Wed Dec 09 2015 20:53:56 GMT+0000 (GMT Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
